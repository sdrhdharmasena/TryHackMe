# Task 7 - IDOR Exploitation

## Task Configuration

**Type:** None  
**AttackBox or VPN enabled:** No  
**Title:** IDOR Exploitation  
**Objective:** Exploit Insecure Direct Object References in the file server  
**Release date:** Instant  
**End date:** Not set  

---

## Task Content

### Introduction

Exploit Insecure Direct Object References in the admin file server.

### What You'll Learn

- IDOR vulnerability exploitation
- File enumeration techniques
- Unauthorized file access

## Instructions üìã

Access the admin file server, analyze file access patterns, enumerate all available files, and locate sensitive administrative data.

## Expected Outcome ‚úÖ

Successfully enumerate files and locate sensitive administrative data.

## üõ°Ô∏è Security Note

IDOR vulnerabilities allow attackers to access resources they shouldn't have permission to view. Always implement proper authorization checks and avoid predictable resource identifiers.

---

## Questions, Answers & Hints

### Question 1

**Question:** What is the name of the first file displayed on the admin file server dashboard?  
**Answer Format:** Text  
**Answer:** readme.txt  
**Points:** 20  
**Hint:** Access the admin dashboard file server section and observe what file is shown by default in the interface.

### Question 2

**Question:** Which file contains company financial information? (Enter the filename)  
**Answer Format:** Text  
**Answer:** sales_report.txt  
**Points:** 15  
**Hint:** Enumerate through the available files and look for files related to financial or sales data.

### Question 3

**Question:** What is the CTF flag found in the secret file? (Format: You_Xxxxx_Xxx_Xxxxxx_Xxxx!)  
**Answer Format:** Text  
**Answer:** You_Found_The_Secret_File!  
**Points:** 30  
**Hint:** Access the secret administrative backup file and examine its contents. The flag should be clearly visible in the expected format.

### Question 4

**Question:** What is the highest file ID number that returns a valid response in the file server?  
**Answer Format:** Number  
**Answer:** 8  
**Points:** 25  
**Hint:** Use IDOR techniques to enumerate through sequential file IDs. Test different ID numbers until you find the highest one that doesn't return a 404 error.

### Question 5

**Question:** What is the file extension of the most sensitive administrative file?  
**Answer Format:** Text  
**Answer:** .bak  
**Points:** 20  
**Hint:** Look for backup files that might contain sensitive administrative data. Backup files often have specific extensions that indicate their nature.

### Question 6

**Question:** Which file ID corresponds to the employee directory?  
**Answer Format:** Number  
**Answer:** 3  
**Points:** 15  
**Hint:** Enumerate through the file IDs and look for a file that contains employee or staff information. Directory files often contain personnel data.

### Question 7

**Question:** What is the size (in bytes) of the marketing plan file?  
**Answer Format:** Number  
**Answer:** 2048  
**Points:** 18  
**Hint:** Find the marketing-related file through IDOR enumeration and check its file size. Look for files with marketing or planning content.

### Question 8

**Question:** What is the highest file ID mentioned in the error message hint when accessing an invalid file?  
**Answer Format:** Number  
**Answer:** 5  
**Points:** 12  
**Hint:** Try accessing a non-existent file or use an invalid filename. Pay attention to any error messages that might reveal information about the file system structure.

---

## Additional Information

## Additional Information üìö

1. **üìã Prerequisites**
   ‚Ä¢ Completion of Tasks 1-6
   ‚Ä¢ Admin access from forged JWT token
   ‚Ä¢ Understanding of URL manipulation

2. **üîß Tools Required**
   ‚Ä¢ Web browser
   ‚Ä¢ Admin JWT token from Task 6
   ‚Ä¢ URL enumeration skills

3. **üìù IDOR Testing Methodology**
   ‚Ä¢ Identify resource access patterns
   ‚Ä¢ Note parameter names and formats
   ‚Ä¢ Test sequential or predictable values
   ‚Ä¢ Document accessible resources
   ‚Ä¢ Look for sensitive information

4. **üìä Common IDOR Locations**
   ‚Ä¢ File downloads: `/files/{id}`
   ‚Ä¢ User profiles: `/user/{id}`
   ‚Ä¢ Orders: `/order/{id}`
   ‚Ä¢ Reports: `/report/{id}`

5. **‚è±Ô∏è Estimated Time**
   ‚Ä¢ 15-20 minutes

6. **üìä Difficulty**
   ‚Ä¢ Intermediate

## Next Steps ‚û°Ô∏è

The secret administrative file you discover contains encoded information that will be needed for Task 8, where you'll decode a Base64 string to reveal the final surprise.