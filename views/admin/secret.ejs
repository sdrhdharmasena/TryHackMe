<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    <%= title %> - BrewMaster Coffee
  </title>
  <!-- INTENTIONALLY MISSING X-Frame-Options header for clickjacking vulnerability -->
  <!-- This page can be embedded in iframes by malicious sites -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    .btn-coffee {
      background-color: #8B4513;
      border-color: #8B4513;
      color: white;
    }

    .btn-coffee:hover {
      background-color: #A0522D;
      border-color: #A0522D;
      color: white;
    }

    .text-coffee {
      color: #8B4513 !important;
    }

    .secret-section {
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
      padding: 2rem;
      border-radius: 15px;
      margin: 2rem 0;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .flag-display {
      background-color: #2d3436;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      padding: 1rem;
      border-radius: 5px;
      border: 2px solid #00ff00;
      margin: 1rem 0;
    }

    .danger-zone {
      border: 2px dashed #e74c3c;
      padding: 1.5rem;
      border-radius: 10px;
      background-color: rgba(231, 76, 60, 0.1);
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #8B4513;">
    <div class="container">
      <a class="navbar-brand fw-bold" href="/admin/dashboard">
        <i class="fas fa-shield-alt"></i> Secret Admin Panel
      </a>
      <div class="navbar-nav ms-auto">
        <a class="nav-link" href="/admin/dashboard">
          <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
        <a class="nav-link" href="/auth/logout">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <div class="row justify-content-center">
      <div class="col-md-10">
        <div class="secret-section text-center text-white">
          <h1 class="mb-4">
            <i class="fas fa-key fa-2x"></i><br>
            üîê Ultra Secret Admin Area üîê
          </h1>
          <p class="lead">Welcome to the most secure part of our system!</p>
          <small class="text-light">This page contains sensitive administrative functions</small>
        </div>

        <div class="card">
          <div class="card-header text-coffee">
            <h4><i class="fas fa-flag"></i> Mission Accomplished!</h4>
          </div>
          <div class="card-body">
            <div class="alert alert-success">
              <h5>üéâ Clickjacking Vulnerability Successfully Exploited!</h5>
              <p>You have successfully accessed the secret admin panel. This page is vulnerable to clickjacking attacks
                because it lacks proper frame protection headers.</p>
            </div>

            <div class="flag-display text-center">
              <h6>CTF FLAG REVEALED:</h6>
              <h4>
                <%= flag %>
              </h4>
            </div>

            <div class="danger-zone mt-4">
              <h6 class="text-danger"><i class="fas fa-exclamation-triangle"></i> Security Warning</h6>
              <p class="mb-2">This page is intentionally vulnerable to demonstrate clickjacking attacks:</p>
              <ul class="mb-0">
                <li>Missing <code>X-Frame-Options</code> header</li>
                <li>No <code>Content-Security-Policy: frame-ancestors</code> directive</li>
                <li>Can be embedded in malicious iframes</li>
                <li>Susceptible to UI redressing attacks</li>
              </ul>
            </div>

            <div class="row mt-4">
              <div class="col-md-6">
                <div class="card border-warning">
                  <div class="card-header bg-warning">
                    <h6 class="mb-0"><i class="fas fa-bug"></i> Vulnerability Details</h6>
                  </div>
                  <div class="card-body">
                    <p><strong>Attack Vector:</strong> Clickjacking/UI Redressing</p>
                    <p><strong>OWASP Category:</strong> A05:2021 Security Misconfiguration</p>
                    <p><strong>Risk Level:</strong> Medium</p>
                    <p class="mb-0"><strong>Impact:</strong> Trick users into performing unintended actions</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card border-info">
                  <div class="card-header bg-info text-white">
                    <h6 class="mb-0"><i class="fas fa-shield-alt"></i> How to Fix</h6>
                  </div>
                  <div class="card-body">
                    <p><strong>1. Add X-Frame-Options:</strong><br>
                      <code>X-Frame-Options: DENY</code>
                    </p>
                    <p><strong>2. Use CSP Frame Ancestors:</strong><br>
                      <code>Content-Security-Policy: frame-ancestors 'none'</code>
                    </p>
                    <p class="mb-0"><strong>3. Implement frame-busting JavaScript</strong></p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Clickjacking Demo Button (this could be tricked to be clicked) -->
            <div class="text-center mt-4">
              <button class="btn btn-danger btn-lg" onclick="confirmDangerousAction()" id="dangerous-button">
                <i class="fas fa-bomb"></i> DANGEROUS ACTION - Don't Click!
              </button>
              <p class="mt-2 text-muted">
                <small>In a real attack, this button would be invisible and users would be tricked into clicking
                  it</small>
              </p>
            </div>
          </div>
        </div>

        <!-- Exploitation Example -->
        <div class="card mt-4">
          <div class="card-header text-coffee">
            <h5><i class="fas fa-code"></i> Sample Clickjacking Attack</h5>
          </div>
          <div class="card-body">
            <p>An attacker could create a malicious page with code like this:</p>
            <pre class="bg-dark text-light p-3 rounded"><code>&lt;!-- Malicious attacker's page --&gt;
&lt;html&gt;
&lt;body&gt;
    &lt;h1&gt;Win a Free Coffee!&lt;/h1&gt;
    &lt;p&gt;Click the button below to claim your prize:&lt;/p&gt;
    
    &lt;!-- Invisible iframe containing admin panel --&gt;
    &lt;iframe src="http://localhost:3000/admin/secret" 
            style="opacity: 0; position: absolute; top: 100px; left: 50px; width: 300px; height: 200px;"&gt;
    &lt;/iframe&gt;
    
    &lt;!-- Fake button positioned over the real admin button --&gt;
    &lt;button style="position: absolute; top: 150px; left: 100px; background: transparent; border: none; width: 200px; height: 50px;"&gt;
        üéÅ Claim Prize
    &lt;/button&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function confirmDangerousAction() {
      alert('üéØ Clickjacking Attack Simulated!\\n\\nIn a real scenario, this could:\\n- Delete admin accounts\\n- Change system settings\\n- Transfer funds\\n- Expose sensitive data\\n\\nAlways implement proper frame protection!');
    }

    // Frame-busting code (intentionally commented out for demo)
    // if (top !== self) {
    //     top.location = self.location;
    // }

    console.log('üîç Security Notice: This page lacks X-Frame-Options protection');
    console.log('üö® This page can be embedded in malicious iframes');
  </script>

  <!-- This comment shows the vulnerability -->
  <!-- MISSING SECURITY HEADERS: -->
  <!-- X-Frame-Options: DENY -->
  <!-- Content-Security-Policy: frame-ancestors 'none' -->
</body>

</html>